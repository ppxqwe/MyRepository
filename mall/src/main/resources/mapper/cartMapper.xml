<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- cart -->
<mapper namespace="com.ppx.mall.dao.CartDao">
    <!-- This code was generated by TableGo tools, mark 1 begin. -->
    <!-- 字段映射 -->
    <resultMap id="cartMap" type="Cart">
        <id column="id" property="id" jdbcType="BIGINT" />
        <result column="productId" property="productId" jdbcType="BIGINT" />
        <result column="name" property="name" jdbcType="VARCHAR" />
        <result column="imgSrc" property="imgSrc" jdbcType="VARCHAR" />
        <result column="price" property="price" jdbcType="VARCHAR" />
        <result column="count" property="count" jdbcType="INTEGER" />
        <result column="cost" property="cost" jdbcType="VARCHAR" />
        <result column="account" property="account" jdbcType="VARCHAR"/>
    </resultMap>
    <!-- This code was generated by TableGo tools, mark 1 end. -->

    <!-- This code was generated by TableGo tools, mark 2 begin. -->
    <!-- 表查询字段 -->
    <sql id="allColumns">
        c.id, c.productId, c.name, c.imgSrc, c.price, c.count, c.cost, c.account
    </sql>
    <!-- This code was generated by TableGo tools, mark 2 end. -->

    <!-- 查询所有 -->
    <select id="findCartAll" resultMap="cartMap">
        SELECT
            <include refid="allColumns" />
        FROM cart c
    </select>

    <!-- 根据条件参数查询列表 -->
    <select id="findCartByCondition" resultMap="cartMap" parameterType="map">
        SELECT
            <include refid="allColumns" />
        FROM cart c WHERE 1 = 1
        <if test="productId != null">
            AND c.productId = #{productId}
        </if>
        <if test="name != null and name != ''">
            AND c.name = #{name}
        </if>
        <if test="imgSrc != null and imgSrc != ''">
            AND c.imgSrc =#{imgSrc}
        </if>
        <if test="price != null">
            AND c.price = #{price}
        </if>
        <if test="count != null">
            AND c.count = #{count}
        </if>
        <if test="cost != null">
            AND c.cost = #{cost}
        </if>
        <if test="account != null and account != ''">
            AND c.account=#{account}
        </if>
    </select>

    <!-- 根据主键查询信息 -->
    <select id="findCartById" resultType="Cart">
        SELECT
            <include refid="allColumns" />
        FROM cart c WHERE c.id =#{id}
    </select>

    <!-- 新增信息 -->
    <insert id="addCart" parameterType="Cart">
        INSERT INTO cart (
            id, productId, name, imgSrc, price, count, cost, account
        ) VALUES (
            #{id},
            #{productId},
            #{name},
            #{imgSrc},
            #{price},
            #{count},
            #{cost},
            #{account}
        )
    </insert>

    <!-- 批量新增信息 -->
    <insert id="addCarts" parameterType="list">
        INSERT INTO cart (
            id, productId, name, imgSrc, price, count, cost, account
        ) VALUES
        <foreach collection="list" index="index" item="item" separator=",">
            (
                #{item.id},
                #{item.productId},
                #{item.name},
                #{item.imgSrc},
                #{item.price},
                #{item.count},
                #{item.cost},
                #{item.account}
            )
        </foreach>
    </insert>

    <!-- 修改信息 -->
    <update id="updateCart">
        UPDATE cart
        <set>
            <if test="productId != null">
                productId = #{productId},
            </if>
            <if test="name != null">
                name = #{name},
            </if>
            <if test="imgSrc != null">
                imgSrc = #{imgSrc},
            </if>
            <if test="price != null">
                price = #{price},
            </if>
            <if test="count != null">
                count = #{count},
            </if>
            <if test="cost != null">
                cost = #{cost},
            </if>
            <if test="account != null">
                account = #{account}
            </if>
        </set>
        WHERE id = #{id}
    </update>

    <!-- 批量修改信息 -->
    <update id="updateCarts" parameterType="list">
        <foreach collection="list" index="index" item="item" separator=";">
            UPDATE cart
            <set>
                <if test="item.productId != null">
                    productId = #{item.productId},
                </if>
                <if test="item.name != null">
                    name = #{item.name},
                </if>
                <if test="item.imgSrc != null">
                    imgSrc = #{item.imgSrc},
                </if>
                <if test="item.price != null">
                    price = #{item.price},
                </if>
                <if test="item.count != null">
                    count = #{item.count},
                </if>
                <if test="item.cost != null">
                    cost = #{item.cost},
                </if>
                <if test="item.account != null">
                    account = #{item.account}
                </if>
            </set>
            WHERE id = #{item.id}
        </foreach>
    </update>

    <!-- 根据主键删除 -->
    <delete id="deleteCartById" parameterType="long">
        DELETE FROM cart WHERE id = #{id}
    </delete>

    <!-- 根据主键批量删除 -->
    <delete id="deleteCartByIds" parameterType="list">
        DELETE FROM cart WHERE id IN
        <foreach collection="list" index="index" item="id" open="(" separator="," close=")">
            #{id}
        </foreach>
    </delete>

    <!--根据账号清空-->
    <delete id="deleteCartByAccount" parameterType="String">
        delete from cart where account=#{account}
    </delete>
</mapper>